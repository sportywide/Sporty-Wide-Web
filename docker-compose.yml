version: '3'
services:
    base:
        image: sportywide-base
        build:
            context: .
            dockerfile: Dockerfile
    web:
        build:
            context: .
            dockerfile: ./packages/sw-web/Dockerfile
        ports:
            - 3000:3000
        command: dev
        depends_on:
            - base
        volumes:
            - sportywide-app-volume:/opt/app:nocopy
            - /opt/app/node_modules
            - /opt/app/packages/sw-shared/node_modules
            - /opt/app/packages/sw-web/node_modules
    api:
        build:
            context: .
            dockerfile: ./packages/sw-api/Dockerfile
        ports:
            - 5000:5000
        command: dev
        depends_on:
            - base
        volumes:
            - sportywide-app-volume:/opt/app:nocopy
            - /opt/app/node_modules
            - /opt/app/packages/sw-shared/node_modules
            - /opt/app/packages/sw-schema/node_modules
            - /opt/app/packages/sw-api/node_modules

volumes:
    sportywide-app-volume:
        external: true
