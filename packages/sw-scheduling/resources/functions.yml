test:
    handler: src/lambda/test.handler
    events:
        - http:
              cors: true
              path: test
              method: get

fetch-teams:
    handler: src/lambda/crawl/fetch-teams.handler
    events:
        - http:
              cors: true
              path: teams
              method: get
    iamRoleStatements:
        - Effect: 'Allow'
          Action:
              - s3:putObject
          Resource: arn:aws:s3:::sw-data-bucket/*

fetch-players:
    handler: src/lambda/crawl/fetch-players.handler
    events:
        - sns: arn:aws:sns:ap-southeast-2:409050499179:FifaTeamSns
    iamRoleStatements:
        - Effect: 'Allow'
          Action:
              - s3:putObject
          Resource: arn:aws:s3:::sw-data-bucket/*

fetch-fixtures:
    handler: src/lambda/crawl/fetch-fixture.handler
    events:
        - sns: arn:aws:sns:ap-southeast-2:409050499179:FifaTeamSns
    iamRoleStatements:
        - Effect: 'Allow'
          Action:
              - s3:putObject
          Resource: arn:aws:s3:::sw-data-bucket/*

save-teams:
    handler: src/lambda/persist/save-teams.handler
    events:
        - s3:
              bucket: sw-data-bucket
              event: s3:ObjectCreated:*
              rules:
                  - prefix: teams/fifa/
                  - suffix: .json
              existing: true
    iamRoleStatements:
        - Effect: 'Allow'
          Action:
              - sns:*
          Resource: arn:aws:sns:${self:provider.region}:${self:custom.aws.accountId}:FifaTeamSns
        - Effect: 'Allow'
          Action:
              - s3:getObject
          Resource: arn:aws:s3:::sw-data-bucket/*

save-players:
    handler: src/lambda/persist/save-players.handler
    events:
        - s3:
              bucket: sw-data-bucket
              event: s3:ObjectCreated:*
              rules:
                  - prefix: players/fifa/
                  - suffix: .json
              existing: true
    iamRoleStatements:
        - Effect: 'Allow'
          Action:
              - s3:getObject
          Resource: arn:aws:s3:::sw-data-bucket/*

save-fixtures:
    handler: src/lambda/persist/save-fixture.handler
    events:
        - s3:
              bucket: sw-data-bucket
              event: s3:ObjectCreated:*
              rules:
                  - prefix: fixtures
                  - suffix: .json
              existing: true
    iamRoleStatements:
        - Effect: 'Allow'
          Action:
              - s3:getObject
          Resource: arn:aws:s3:::sw-data-bucket/*
